import torch

tensor1 = torch.tensor([[1, 2, 3], [4, 5, 6], [7, 8, 9]])
tensor2 = torch.tensor([[2, 2, 3], [4, 5, 6], [7, 8, 9]])
# tensor([[30, 36, 42], [66, 81, 96], [102, 126, 150]])
tensor3 = torch.matmul(tensor1, tensor2)
# tensor([[30, 36, 42], [66, 81, 96], [102, 126, 150]])
tensor4 = torch.mm(tensor1, tensor2)

# tensor([[ 9, 18, 27]
bx = torch.rand(7, 3, 5)
by = torch.rand(7, 5, 4)

a = torch.arange(3, 10, 3)
b = torch.arange(3, 10, 3)

# tensor([[[0.6749, 0.7193, 0.8814, 0.6854],
#          [0.6197, 1.3264, 1.1491, 1.3924],
#          [0.6459, 1.0801, 0.9390, 0.9343]],

#         [[0.8804, 0.8979, 1.4428, 1.6089],
#          [1.3038, 1.1767, 1.6460, 2.0195],
#          [0.8794, 1.0223, 1.5123, 1.6495]],

#         [[0.4255, 1.2237, 0.4002, 0.6197],
#          [1.2321, 1.9274, 1.0274, 2.1490],
#          [1.0000, 1.6911, 1.0193, 1.8631]],

#         [[1.7021, 1.3621, 1.2035, 1.2310],
#          [1.6078, 1.4580, 1.3562, 1.4285],
#          [1.4501, 1.1987, 1.0867, 1.2028]],

#         [[1.4318, 1.5337, 1.4398, 1.6631],
#          [1.3813, 1.5141, 1.2611, 1.0704],
#          [1.3984, 1.4427, 2.0104, 1.5588]],

#         [[1.6539, 1.1151, 1.2848, 1.5238],
#          [2.3010, 1.2844, 1.7963, 2.0991],
#          [2.4956, 1.5680, 1.6593, 2.1263]],

#         [[1.6410, 0.7518, 1.0714, 1.0720],
#          [0.8953, 0.6919, 1.1638, 0.8945],
#          [1.9363, 1.1844, 1.6543, 1.4190]]])
bc = torch.bmm(bx, by)
# tensor(126)
bd = torch.dot(a, b)
# tensor([[9, 18, 27], [18, 36, 54], [27, 54, 81]])
be = torch.outer(a, b)

v = torch.Tensor([1, 2, 3])
matrix = torch.Tensor([[4, 2, 3], [4, 5, 6], [7, 8, 9]])

mv = torch.mv(matrix, v)

linalg = torch.linalg.matrix_rank(matrix)
solve = torch.linalg.solve(matrix, v)

invA = torch.linalg.inv(matrix)
x = torch.mv(invA, v)

print(solve, invA, x)
